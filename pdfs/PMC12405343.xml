


<OAI-PMH xmlns="http://www.openarchives.org/OAI/2.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
    <responseDate>2025-09-09T13:49:23Z</responseDate>
    <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:12405343" metadataPrefix="pmc">https://pmc.ncbi.nlm.nih.gov/api/oai/v1/mh/</request>
    
    <GetRecord>
        <record>
    <header>
    <identifier>oai:pubmedcentral.nih.gov:12405343</identifier>
    <datestamp>2025-09-04</datestamp>
    
        
        <setSpec>pmc-open</setSpec>
        
    
</header>
    <metadata>
        
        <article xmlns="https://jats.nlm.nih.gov/ns/archiving/1.4/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.4/ https://jats.nlm.nih.gov/archiving/1.4/xsd/JATS-archivearticle1-4.xsd" article-type="research-article" xml:lang="en" dtd-version="1.4"><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">World J Urol</journal-id><journal-id journal-id-type="iso-abbrev">World J Urol</journal-id><journal-id journal-id-type="pmc-domain-id">365</journal-id><journal-id journal-id-type="pmc-domain">springeropen</journal-id><journal-title-group><journal-title>World Journal of Urology</journal-title></journal-title-group><issn pub-type="ppub">0724-4983</issn><issn pub-type="epub">1433-8726</issn><custom-meta-group><custom-meta><meta-name>pmc-is-collection-domain</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-collection-title</meta-name><meta-value>Springer</meta-value></custom-meta></custom-meta-group></journal-meta><article-meta><article-id pub-id-type="pmcid">PMC12405343</article-id><article-id pub-id-type="pmcid-ver">PMC12405343.1</article-id><article-id pub-id-type="pmcaid">12405343</article-id><article-id pub-id-type="pmcaiid">12405343</article-id><article-id pub-id-type="pmid">40892093</article-id><article-id pub-id-type="doi">10.1007/s00345-025-05904-x</article-id><article-id pub-id-type="publisher-id">5904</article-id><article-version article-version-type="pmc-version">1</article-version><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Flexible ureteroscopy in renal anomalies: an explainable AI model for surgical outcome prediction from EAU endourology</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2031-347X</contrib-id><name name-style="western"><surname>Nedbal</surname><given-names initials="C">Carlotta</given-names></name><address><email>carlottanedbal@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff7">7</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Gauhar</surname><given-names initials="V">Vineet</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Adithya</surname><given-names initials="S">Sairam</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Naik</surname><given-names initials="N">Nithesh</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Gite</surname><given-names initials="S">Shilpa</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Sevalia</surname><given-names initials="H">Het</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Castellani</surname><given-names initials="D">Daniele</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Gregori</surname><given-names initials="A">Andrea</given-names></name><xref ref-type="aff" rid="Aff7">7</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Panthier</surname><given-names initials="F">Fr&#233;d&#233;ric</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff8">8</xref><xref ref-type="aff" rid="Aff9">9</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Tanidir</surname><given-names initials="Y">Yiloren</given-names></name><xref ref-type="aff" rid="Aff10">10</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Shrestha</surname><given-names initials="A">Anil</given-names></name><xref ref-type="aff" rid="Aff11">11</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Sridharan</surname><given-names initials="V">Vikram</given-names></name><xref ref-type="aff" rid="Aff12">12</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Singh</surname><given-names initials="A">Abhishek</given-names></name><xref ref-type="aff" rid="Aff13">13</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Soebhali</surname><given-names initials="B">Boyke</given-names></name><xref ref-type="aff" rid="Aff14">14</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Lakmichi</surname><given-names initials="MA">Mohamed Amine</given-names></name><xref ref-type="aff" rid="Aff15">15</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Hamri</surname><given-names initials="SB">Saeed Biin</given-names></name><xref ref-type="aff" rid="Aff16">16</xref></contrib><contrib contrib-type="author"><name name-style="western"><surname>Somani</surname><given-names initials="BK">Bhaskar Kumar</given-names></name><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff17">17</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00x69rs40</institution-id><institution-id institution-id-type="GRID">grid.7010.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 1017 3210</institution-id><institution>Present Address: Polytechnic University Le Marche, </institution></institution-wrap>Ancona, Italy </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00m9mc973</institution-id><institution-id institution-id-type="GRID">grid.466642.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0646 1238</institution-id><institution>Endourology Section, </institution><institution>European Association of Urology, </institution></institution-wrap>Arnhem, The Netherlands </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/055vk7b41</institution-id><institution-id institution-id-type="GRID">grid.459815.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0493 0168</institution-id><institution>Urology, </institution><institution>Ng Teng Fong General Hospital, </institution></institution-wrap>Singapore, Singapore </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/005r2ww51</institution-id><institution-id institution-id-type="GRID">grid.444681.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 0503 4808</institution-id><institution>Engineering, </institution><institution>Symbiosis Institute of Technology, </institution></institution-wrap>Pune, India </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02xzytt36</institution-id><institution-id institution-id-type="GRID">grid.411639.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0571 5193</institution-id><institution>Engineering, </institution><institution>Manipal Academy of Higher Education, </institution></institution-wrap>Manipal, India </aff><aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0213f0637</institution-id><institution-id institution-id-type="GRID">grid.411490.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 6306</institution-id><institution>Azienda Ospedaliero-Universitaria Ospedali Riuniti di Ancona, </institution></institution-wrap>Ancona, Italy </aff><aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01xf83457</institution-id><institution-id institution-id-type="GRID">grid.415025.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 1756 8604</institution-id><institution>IRCSS San Gerardo, </institution></institution-wrap>Monza, Italy </aff><aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02en5vm52</institution-id><institution-id institution-id-type="GRID">grid.462844.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2308 1657</institution-id><institution>GRC Urolithiasis No. 20, Tenon Hospital, </institution><institution>Sorbonne University, </institution></institution-wrap>Paris, France </aff><aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/017jp7t31</institution-id><institution-id institution-id-type="GRID">grid.464008.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 0370 3510</institution-id><institution>PIMM, UMR 8006 CNRS-Arts et M&#233;tiers ParisTech, </institution></institution-wrap>Paris, France </aff><aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02kswqa67</institution-id><institution-id institution-id-type="GRID">grid.16477.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0668 8422</institution-id><institution>Department of Urology, </institution><institution>Marmara University School of Medicine, </institution></institution-wrap>Istanbul, Turkey </aff><aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03pskkc12</institution-id><institution-id institution-id-type="GRID">grid.416519.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 0468 9079</institution-id><institution>Department of Urology, Bir Hospital, </institution><institution>National Academy of Medical Sciences, </institution></institution-wrap>Kanti Path, Kathmandu, Nepal </aff><aff id="Aff12"><label>12</label>Department of Urology, Sree Paduka Speciality Hospital, Thillai Nagar, Tiruchirappalli, India </aff><aff id="Aff13"><label>13</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/059h1d250</institution-id><institution-id institution-id-type="GRID">grid.416255.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1768 1324</institution-id><institution>Muljibhai Patel Urological Hospital, </institution></institution-wrap>Nadiad, Gujarat India </aff><aff id="Aff14"><label>14</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02kwq2y85</institution-id><institution-id institution-id-type="GRID">grid.444232.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9609 1699</institution-id><institution>Department of Urology, Abdul Wahab Sjahranie Hospital Medical Faculty, </institution><institution>Muliawarman University, </institution></institution-wrap>Samarinda, Indonesia </aff><aff id="Aff15"><label>15</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05syd6y78</institution-id><institution-id institution-id-type="GRID">grid.20736.30</institution-id><institution-id institution-id-type="ISNI">0000 0001 1941 472X</institution-id><institution>Department of Urology, School of Medicine, Hospital das Cl&#237;nicas, </institution><institution>Federal University of Paran&#225;, </institution></institution-wrap>Curitiba, Brazil </aff><aff id="Aff16"><label>16</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/009p8zv69</institution-id><institution-id institution-id-type="GRID">grid.452607.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 0580 0891</institution-id><institution>King Abdullah International Medical Research Centre, Department of Surgery, </institution></institution-wrap>Riyadh, Saudi Arabia </aff><aff id="Aff17"><label>17</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0485axj58</institution-id><institution-id institution-id-type="GRID">grid.430506.4</institution-id><institution>University Hospital Southampton NHS Foundation Trust, </institution></institution-wrap>Southampton, UK </aff></contrib-group><pub-date pub-type="epub"><day>2</day><month>9</month><year>2025</year></pub-date><pub-date pub-type="ppub"><year>2025</year></pub-date><volume>43</volume><issue>1</issue><issue-id pub-id-type="pmc-issue-id">496088</issue-id><elocation-id>530</elocation-id><history><date date-type="received"><day>23</day><month>6</month><year>2025</year></date><date date-type="accepted"><day>21</day><month>8</month><year>2025</year></date></history><pub-history><event event-type="pmc-release"><date><day>02</day><month>09</month><year>2025</year></date></event><event event-type="pmc-live"><date><day>04</day><month>09</month><year>2025</year></date></event><event event-type="pmc-last-change"><date iso-8601-date="2025-09-04 00:25:59.930"><day>04</day><month>09</month><year>2025</year></date></event></pub-history><permissions><copyright-statement>&#169; The Author(s) 2025</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#8217;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#8217;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><self-uri content-type="pmc-pdf" xlink:href="345_2025_Article_5904.pdf"/><abstract id="Abs1" abstract-type="structured"><sec><title>Aim and objective</title><p id="Par1">Flexible ureteroscopy (fURS) is a well-established modality for managing urolithiasis in patients with congenital renal anomalies such as horseshoe kidneys (HK), malrotated kidneys (MK), and pelvic ectopic kidneys (PEK). Still, these anatomical variants present unique challenges that complicate stone clearance and procedural planning. We aim to apply machine learning (ML) and explainable artificial intelligence (XAI) techniques to identify predictors of stone-free status (SFS) following fURS in patients with anomalous kidneys.</p></sec><sec><title>Methods</title><p id="Par2">We retrospectively analysed adult patients with HK, MK, or EK who underwent fURS and laser lithotripsy for renal stones at a tertiary referral center. A ML model incorporating clinical and intraoperative variables was developed to predict SFS. SHAP (SHapley Additive exPlanations) values and decision tree analysis were used to interpret feature importance and model behaviour.</p></sec><sec><title>Results</title><p id="Par3">A total of 569 cases were analysed between 2017 and 2021, with a female: male ratio of 3:1. Regarding anatomical anomalies, 50.62% had HSK, 22.67% had PEK and 26.71% had MK. Most of the patients presented with multiple (59.58%), small (76.80%) and soft stones (56.94%). MK showed the highest SFS rates, suggesting this is the most favourable anomaly for fURS. The presence of residual fragments at the end of the procedure was the strongest negative predictor of SFS, followed by longer operative time and older patient age. PEK exhibited the greatest heterogeneity in outcomes. SHAP analysis provided individualized and global insights into feature contributions.</p></sec><sec><title>Conclusion</title><p id="Par4">Explainable AI offers a transparent and clinically meaningful approach to predicting SFS in patients with renal anomalies undergoing fURS. These insights can guide preoperative risk stratification and inform surgical strategy in a domain where standardised evidence is lacking.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Ureteroscopy</kwd><kwd>Renal anomalies</kwd><kwd>Machine learning</kwd><kwd>Predictive model</kwd><kwd>Stone free rate</kwd><kwd>Explainable AI</kwd></kwd-group><funding-group><award-group><funding-source><institution>Universit&#224; Politecnica delle Marche</institution></funding-source></award-group><open-access><p>Open access funding provided by Universit&#224; Politecnica delle Marche within the CRUI-CARE Agreement.</p></open-access></funding-group><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#169; Springer-Verlag GmbH Germany, part of Springer Nature 2025</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par5">Flexible ureteroscopy (fURS) has become a widely adopted technique for the management of renal and ureteric calculi [<xref ref-type="bibr" rid="CR1">1</xref>]. However, its application in patients with congenital renal anomalies, such as malrotated, ectopic, or horseshoe kidneys remains a clinical challenge. Anatomical variations complicate access, increase the risk of complications, and may impact the success of stone clearance [<xref ref-type="bibr" rid="CR2">2</xref>].</p><p id="Par6">Despite its growing use, and new literature evidence on safety and efficacy of fURSL in congenital renal anomalies, there is a lack of standardized guidelines addressing URS outcomes in these complex anatomical settings, making clinical decision-making highly dependent on individual experience and intraoperative judgment [<xref ref-type="bibr" rid="CR3">3</xref>]. As reported by the European Association of Urology (EAU) guidelines, all standard treatment lines are feasible, including fURS, percutaneous nephrolithotomy (PCNL) and shock wave lithotripsy [<xref ref-type="bibr" rid="CR4">4</xref>]. Nevertheless, typical outcomes (especially for horseshoe kidney disease) are usually lower compared to the control population, with acceptable stone free rates (SFRs) (up to 76%). URS is still considered the safest option, with low major complication rates (2.4%) [<xref ref-type="bibr" rid="CR5">5</xref>].</p><p id="Par7">In this context, predictive modelling using artificial intelligence (AI) and machine learning (ML) algorithms holds promise for improving patient outcomes, stratification and procedural planning. Traditional AI models often function as &#8220;black boxes,&#8221; providing limited insight into how predictions are generated&#8212;an issue that is especially problematic in high-stakes clinical settings [<xref ref-type="bibr" rid="CR6">6</xref>]. Explainable AI (XAI) addresses this challenge by making model logic interpretable and clarifying the contribution of individual features to the output [<xref ref-type="bibr" rid="CR7">7</xref>].</p><p id="Par8">This report explores the application of decision trees and SHAP (SHapley Additive exPlanations) values in a model designed to predict outcome of fURS for urolithiasis in patients with known anatomical kidney anomalies. The objective is to highlight the most influential predictors, examine class distribution patterns, and provide clinicians with data-driven insights to support management strategies in anatomically complex scenarios.</p></sec><sec id="Sec200"><title>Materials and methods</title><sec id="Sec101"><title>Database: patients selection, data collection and procedures</title><p id="Par9">Patient data were retrospectively analysed from individuals who underwent flexible fURS for urolithiasis between 2017 and 2021 in nineteen high volume centers. Operative results were collected in a large multicentric database, and have been presented in a previous study [<xref ref-type="bibr" rid="CR1">1</xref>]. The study focused exclusively on adult patients diagnosed with congenital renal anomalies, including horseshoe kidney (HK), malrotated kidney (MK), and pelvic ectopic kidney (PEK). Inclusion criteria required patients to have one or more renal calculi and to have been treated with fURS combined with laser lithotripsy (fURSL). Only cases with confirmed anatomical abnormalities and complete procedural records were included in the final dataset.</p><p id="Par10">Preoperative and demographic characteristics were collected, including age, gender, comorbidities, stone number (single or multiple), size (&lt;&#8201;20&#160;mm, &#8805;&#8201;20&#160;mm) and density (&lt;&#8201;1000 HU, &#8805;&#8201;1000 HU). Preoperative imaging consisted of plain or contrast-enhanced CT scan to evaluate anatomy and stone features. Patients undergoing fURS for other diagnosis than urolithiasis (i.e., upper tract tumour), paediatric patients, patients without anomalous kidneys anatomy, and patients not giving consent for data collection were excluded from the study. Every patient received specialistic counselling before surgery, an informed consent and permission towards data registration were routinely obtained. All patients were tested for urine analysis to rule out any ongoing infection, and a sterile sample was required to proceed with surgery. Intraoperative recorded data included: operative time, intraoperative haematuria limiting vision, failed procedure with abandoned operation, presence of on-table residual fragments (RF). After the procedure, the following parameters were collected: postoperative sepsis, need for reintervention, SFR at 3-months follow-up CT-KUB (defined as absence of RF, or RF&#8201;&lt;&#8201;2&#160;mm).</p></sec><sec id="Sec105"><title>ML algorithms training and data analysis</title><p id="Par11">The workflow commenced with data cleaning and preprocessing, which included eliminating irrelevant characters and imputing missing categorical values using the mode. Subsequently, statistical analyses were conducted, and these encompassed correlation assessments, Variance Inflation Factor (ViF) evaluations, and logistic regression across four distinct prediction tasks. Next, a suite of eighteen ML models was trained individually. These included Probabilistic Models (Naive Bayes, Logistic Regression), Instance-Based (Lazy) Learning (K-Nearest Neighbors &#8211; KNN), Linear Models (Logistic Regression, Linear Discriminant Analysis &#8211; LDA, SVM &#8211; Linear), Discriminant Analysis (Linear Discriminant Analysis &#8211; LDA, Quadratic Discriminant Analysis &#8211; QDA), Support Vector Machines (SVM: SVM &#8211; Linear SVM &#8211; Poly, SVM &#8211; RBF), Tree-Based Models (Decision Tree, Random Forest, Extra Trees Classifier, Bagging Classifier, Gradient Boosting, CatBoost Classifier, XGBoost). Each model was designed to predict clinical outcomes based on preoperative features.</p><p id="Par12">In parallel, a multitask artificial neural network (ANN) was constructed to predict all outcomes concurrently. This ANN incorporated shared hidden layers for common feature extraction, along with task-specific output layers, employing ReLU activation functions for hidden layers and sigmoid functions for the outputs. Model evaluation was carried out using confusion matrices and classification reports, yielding key performance metrics such as accuracy, precision, recall, and F1 score.</p><p id="Par13">To enhance the interpretability of complex models like the ANN, explainable AI techniques were applied, specifically SHAP value analysis and feature importance mapping, to clarify the model&#8217;s decision-making process and spotlight the most influential input variables.</p></sec></sec><sec id="Sec3"><title>Results</title><sec id="Sec22"><title>Results from the database</title><p id="Par14">A total of 569 cases were recorded and deemed eligible for the analysis during the observation period. With a mean age of 44.51 years, 73.46% were female and 26.54% male. 122 patients had hypertension (HTN), 125 had diabetes mellitus (DM), and 47 had known cardiovascular disease. Regarding anatomical anomalies, patients with HSK were the majority, accounting for 50.62% of the total, while PEK was present in 22.67% and MK in 26.71% cases. Most of the patients presented with multiple (59.58%), small (76.80%) and soft stones (56.94%). Table&#160;<xref rid="Tab1" ref-type="table">1</xref> summarises preoperative findings.</p><p id="Par15">
<table-wrap id="Tab1" position="float" orientation="portrait"><label>Table 1</label><caption><p>Intraoperative findings</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="1" rowspan="1"/><th align="left" colspan="1" rowspan="1">No. (%)</th><th align="left" colspan="1" rowspan="1">Mean age, years</th><th align="left" colspan="1" rowspan="1">HTN (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">DM (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">CVD (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">HSK (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">PEK (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">MK (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Multiple stones (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Large stone(s) (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Hard stone(s) (<italic toggle="yes">n</italic>, %)</th></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">Female</td><td align="left" colspan="1" rowspan="1">418 (73.46%)</td><td char="." align="char" colspan="1" rowspan="1">44.46</td><td char="." align="char" colspan="1" rowspan="1">94 (22.49%)</td><td char="." align="char" colspan="1" rowspan="1">89 (21.29%)</td><td char="." align="char" colspan="1" rowspan="1">34 (8.13%)</td><td char="." align="char" colspan="1" rowspan="1">221 (52.87%)</td><td char="." align="char" colspan="1" rowspan="1">86 (20.57%)</td><td char="." align="char" colspan="1" rowspan="1">111 (26.56%)</td><td char="." align="char" colspan="1" rowspan="1">252 (60.29%)</td><td char="." align="char" colspan="1" rowspan="1">92 (22.00%)</td><td char="." align="char" colspan="1" rowspan="1">176 (42.11%)</td></tr><tr><td align="left" colspan="1" rowspan="1">Male</td><td align="left" colspan="1" rowspan="1">151 (26.54%)</td><td char="." align="char" colspan="1" rowspan="1">44.66</td><td char="." align="char" colspan="1" rowspan="1">28 (18.54%)</td><td char="." align="char" colspan="1" rowspan="1">36 (23.84%)</td><td char="." align="char" colspan="1" rowspan="1">13 (8.61%)</td><td char="." align="char" colspan="1" rowspan="1">67 (44.37%)</td><td char="." align="char" colspan="1" rowspan="1">43 (28.48%)</td><td char="." align="char" colspan="1" rowspan="1">41 (27.15%)</td><td char="." align="char" colspan="1" rowspan="1">87 (57.62%)</td><td char="." align="char" colspan="1" rowspan="1">40 (26.49%)</td><td char="." align="char" colspan="1" rowspan="1">69 (45.70%)</td></tr><tr><td align="left" colspan="1" rowspan="1">Total</td><td align="left" colspan="1" rowspan="1">569</td><td char="." align="char" colspan="1" rowspan="1">44.51</td><td char="." align="char" colspan="1" rowspan="1">122 (21.44%)</td><td char="." align="char" colspan="1" rowspan="1">125 (21.97%)</td><td char="." align="char" colspan="1" rowspan="1">47 (8.26%)</td><td char="." align="char" colspan="1" rowspan="1">288 (50.62%)</td><td char="." align="char" colspan="1" rowspan="1">129 (22.67%)</td><td char="." align="char" colspan="1" rowspan="1">152 (26.71%)</td><td char="." align="char" colspan="1" rowspan="1">339 (59.58%)</td><td char="." align="char" colspan="1" rowspan="1">132 (23.20%)</td><td char="." align="char" colspan="1" rowspan="1">245 (43.06%)</td></tr></tbody></table></table-wrap>
</p><p id="Par16">Overall, 34 patients developed significant haematuria, and operation was abandoned due to impossibility to proceed in 16 cases. 53 patients developed postoperative sepsis requiring prolonged intravenous antibiotics. On-table evaluation deemed patients stone-free in 78.56% cases, with confirmatory CT-KUB at 3-months follow-up revealing SFR at 72.06%. Table <xref rid="Tab2" ref-type="table">2</xref> shows intraoperative and postoperative results</p><p id="Par17">
<table-wrap id="Tab2" position="float" orientation="portrait"><label>Table 2</label><caption><p>Postoperative results divided per type of anatomical anomaly</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="1" rowspan="1"/><th align="left" colspan="1" rowspan="1">Haematuria (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Sepsis (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Abandoned operation (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">on-table RF (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">Reintervention (<italic toggle="yes">n</italic>, %)</th><th align="left" colspan="1" rowspan="1">SF (<italic toggle="yes">n</italic>, %)</th></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">HSK</td><td char="." align="char" colspan="1" rowspan="1">18 (6.25%)</td><td char="." align="char" colspan="1" rowspan="1">27 (9.38%)</td><td char="." align="char" colspan="1" rowspan="1">10 (3.47%)</td><td char="." align="char" colspan="1" rowspan="1">70 (24.31%)</td><td char="." align="char" colspan="1" rowspan="1">30 (10.42%)</td><td char="." align="char" colspan="1" rowspan="1">214 (74.31%)</td></tr><tr><td align="left" colspan="1" rowspan="1">PEK</td><td char="." align="char" colspan="1" rowspan="1">9 (6.98%)</td><td char="." align="char" colspan="1" rowspan="1">13 (10.08%)</td><td char="." align="char" colspan="1" rowspan="1">2 (1.55%)</td><td char="." align="char" colspan="1" rowspan="1">28 (21.71%)</td><td char="." align="char" colspan="1" rowspan="1">14 ( 10.85%)</td><td char="." align="char" colspan="1" rowspan="1">77 (59.69%)</td></tr><tr><td align="left" colspan="1" rowspan="1">MK</td><td char="." align="char" colspan="1" rowspan="1">7 (4.61%)</td><td char="." align="char" colspan="1" rowspan="1">13 (8.55%)</td><td char="." align="char" colspan="1" rowspan="1">4 (2.63%)</td><td char="." align="char" colspan="1" rowspan="1">24 (15.79%)</td><td char="." align="char" colspan="1" rowspan="1">13 (8.55%)</td><td char="." align="char" colspan="1" rowspan="1">119 (78.29%)</td></tr><tr><td align="left" colspan="1" rowspan="1">Total</td><td char="." align="char" colspan="1" rowspan="1">34 (5.98%)</td><td char="." align="char" colspan="1" rowspan="1">53 (9.31%)</td><td char="." align="char" colspan="1" rowspan="1">16 (2.81%)</td><td char="." align="char" colspan="1" rowspan="1">122 (21.44%)</td><td char="." align="char" colspan="1" rowspan="1">57 (10.02%)</td><td char="." align="char" colspan="1" rowspan="1">410 (72.06%)</td></tr></tbody></table></table-wrap>
</p></sec><sec id="Sec47"><title>On-table RF</title><sec id="Sec4"><title>ML training and testing results</title><p id="Par18">Gradient Boosting is the top model with 89.47% training accuracy, 73.68% validation accuracy, and the highest F1-score (63.60%), showing strong generalization. Decision Tree, Random Forest, and Extra Trees perform well but may overfit (96.53% training, ~&#8201;72.81% validation). XGBoost (95.84% training, 71.05% validation, 60.46% F1) and CatBoost (91.41% training, 70.17% validation, 58.75% F1) offer balanced performance. Bagging Classifier (95.43% training, 71.05% validation, 59.49% F1) is another good ensemble option. Logistic Regression (75.48% training, 64.04% validation, 59.27% F1) and LDA (76.18% training, 64.92% validation, 58.77% F1) provide consistent performance. AdaBoost (79.36% training, 57.23% validation, 57.35% F1) has a solid F1-score but lower validation accuracy. Gradient Boosting resulted to be the top choice, followed by XGBoost and CatBoost for balanced performance. Logistic Regression and LDA appeared reliable for generalization, while SVM-RBF and Na&#239;ve Bayes were not suitable.</p></sec><sec id="Sec5"><title>Analysis of correlation and logistic regression</title><p id="Par19">Reintervention was the strongest predictor of on-table RF (<italic toggle="yes">r</italic>&#8201;=&#8201;0.4686), indicating a high likelihood of RF in cases requiring a second procedure. Other associated factors included longer operative times (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2056), abandoned operations (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2105), and haematuria (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1718). Sepsis (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1254) and HSK (<italic toggle="yes">r</italic>&#8201;=&#8201;0.0752) were also weakly correlated with RF. In contrast, a 3-month complete SFS (<italic toggle="yes">r</italic>=-0.6255) was strongly negatively correlated with on-table RF. Additionally, multiple stones (<italic toggle="yes">r</italic>=-0.1440), larger stone diameter (<italic toggle="yes">r</italic>=-0.0501), and higher HU values (<italic toggle="yes">r</italic>=-0.0071) showed weak negative associations with RF.</p><p id="Par20">The model performance metrics show a Log-Likelihood of -166.66, indicating the model fit, with a higher (less negative) value being preferred. The Pseudo R-squared of 0.1163 suggests that the model explains 11.63% of the variance, which is relatively low. The LLR p-value is highly significant (&lt;&#8201;0.001), confirming that the overall model is statistically significant. Additionally, the model successfully converged, with no numerical stability issues.</p></sec></sec><sec id="Sec48"><title>Need for reintervention</title><sec id="Sec6"><title>ML training and testing results</title><p id="Par21">CatBoost lead with the highest validation accuracy (91.22%) and strong F1-score (61.94%). AdaBoost follows closely with 90.35% validation accuracy and 60.75% F1, showing minimal overfitting. Gradient Boosting had the highest validation accuracy (92.10%) but a lower F1-score (47.95%), suggesting class imbalance. XGBoost (87.19% validation, 57.77% F1) and Bagging Classifier (87.19% validation, 57.77% F1) performed well but show slight overfitting. Logistic Regression (80.70% validation, 57.78% F1) and LDA (84.21% validation, 56.67% F1) provided decent generalization. KNN (78.07% validation, 50.61% F1) performed reasonably but with a weaker F1-score. CatBoost, AdaBoost, and Gradient Boosting are the top models. XGBoost and Bagging Classifier showed good performance with slight overfitting, while Decision Trees, Random Forest, and Extra Trees show overfitting. SVM-Poly and Na&#239;ve Bayes underperformed.</p></sec><sec id="Sec7"><title>Analysis of correlation and logistic regression</title><p id="Par22">On-table RF was the strongest predictor of reintervention (<italic toggle="yes">r</italic>&#8201;=&#8201;0.4066), indicating that patients who demonstrate incomplete clearance during surgery are more likely to require additional procedures. Other moderate risk factors for reintervention include haematuria (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2120), sepsis (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1723), and abandoned operations (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1898). Higher stone density also showed a weak positive correlation (<italic toggle="yes">r</italic>&#8201;=&#8201;0.0523) with reintervention, as did cardiovascular disease (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1067). Conversely, achieving a complete stone free status (SFS) (<italic toggle="yes">r</italic>=-0.2877) significantly reduced the likelihood of needing reintervention. Longer surgeries (<italic toggle="yes">r</italic>=-0.0113) and multiple stones (<italic toggle="yes">r</italic>=-0.0845) showed weak negative correlations, with little impact on the need for additional procedures.</p><p id="Par23">The model performance metrics show a Log-Likelihood of -135.42, indicating the model&#8217;s fit, with a higher (less negative) value preferred. The Pseudo R-squared of 0.07306 suggests that the model explains only 7.31% of the variance, indicating relatively low predictive power. The LLR p-value of 0.01880 is statistically significant (<italic toggle="yes">p</italic>&#8201;&lt;&#8201;0.05), confirming that the overall model is significant. Additionally, the model successfully converged without any numerical stability issues.</p></sec></sec><sec id="Sec50"><title>Stone free status (SFS)</title><sec id="Sec8"><title>ML training and testing results</title><p id="Par24">LDA was the top performer with the highest F1-score (61.97%) and strong balance between precision and recall. QDA had slightly higher validation accuracy (70.18%) but a lower F1-score (41.23%), indicating class imbalance. Random Forest and Extra Trees showed signs of overfitting despite decent F1-scores (~&#8201;57%). Gradient Boosting (63.16% validation, 55.21% F1) and Bagging (52.44% F1) offered good generalization. Logistic Regression (64.91% validation, 60.52% F1) showed solid, balanced performance. KNN performed moderately (55.92% F1) but with lower validation accuracy. Overall, LDA is the best choice, with Logistic Regression, Gradient Boosting, and QDA also performing well.</p></sec><sec id="Sec53"><title>Analysis of correlation and logistic regression</title><p id="Par25">Larger stone diameter (=&#8201;0.6306) and MK (<italic toggle="yes">r</italic>&#8201;=&#8201;0.8384) were the strongest positive predictors of SFS, suggesting that larger stones and certain anatomical anomalies are more likely to result in complete stone removal. A single stone (<italic toggle="yes">r</italic>&#8201;=&#8201;0.0899) also showed a slight positive correlation with SFS. On the other hand, on-table RF (<italic toggle="yes">r</italic>=-0.6255), need for reintervention (<italic toggle="yes">r</italic>=-0.2877), and longer operative times (<italic toggle="yes">r</italic>=-0.1118) were strongly and moderately negatively correlated with SFS, indicating that these factors hinder complete stone removal. Additionally, complications such as haematuria (<italic toggle="yes">r</italic>=-0.0410) and sepsis (<italic toggle="yes">r</italic>=-0.0501), as well as abandoned operations (<italic toggle="yes">r</italic>=-0.0888), showed weak negative correlations, slightly reducing the likelihood of achieving SFS.</p><p id="Par26">The model performance metrics show a Log-Likelihood of -203.83, indicating the model&#8217;s fit, with a higher (less negative) value preferred. The Pseudo R-squared of 0.07604 suggests that the model explains only 7.60% of the variance, indicating relatively low predictive power. The LLR p-value of 0.0002200 is highly significant, confirming that the overall model is statistically significant. Additionally, the model successfully converged without any numerical stability issues.</p></sec><sec id="Sec52"><title>XAI</title><p id="Par27">In the decision tree model (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>), several key features were identified as significant predictors of SFS during ureteroscopy. The most important feature, on-table RF, contributed approximately 30% to the model&#8217;s prediction. Other notable features included operative time and age, each contributing over 10%. Anatomical factors such as MK were strongly associated with a higher likelihood of achieving SFS, while features like the number of uroliths and the presence of PEK played a crucial role in distinguishing between stone-free and non-stone-free cases. The decision tree model provided a clear classification structure, with decision nodes based on these critical features influencing the likelihood of achieving SFS.</p><p id="Par28">
<fig id="Fig1" position="float" orientation="portrait"><label>Fig. 1</label><caption><p>XAI: Decision tree for SFS</p></caption><graphic id="d33e897" position="float" orientation="portrait" xlink:href="345_2025_5904_Fig1_HTML.jpg"/></fig>
</p><p id="Par29">The SHAP waterfall plot (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>) revealed how different features contributed to the final model prediction. The base value, representing the expected outcome before considering feature contributions, was 0.5. The most influential feature was on-table RF, which increased the model&#8217;s prediction by +&#8201;0.23. Other features, including operative time and need for reintervention, contributed smaller positive and negative values to the prediction. The final model output, after considering all feature contributions, was 1.0, reflecting the overall classification. This plot highlighted the cumulative effect of various features in driving the model&#8217;s prediction towards the final classification.</p><p id="Par30">
<fig id="Fig2" position="float" orientation="portrait"><label>Fig. 2</label><caption><p>XAI: SHAP waterfall plot for SFS</p></caption><graphic id="d33e912" position="float" orientation="portrait" xlink:href="345_2025_5904_Fig2_HTML.jpg"/></fig>
</p><p id="Par31">The SHAP summary plot further emphasized the impact of different features on the model&#8217;s predictions. The plot showed that features such as on-table RF and the number of stones had a wide spread of SHAP values, indicating that their impact varied significantly depending on the instance. For instance, on-table RF exhibited both positive and negative contributions, suggesting its influence was context-dependent. Conversely, features like operative time and sepsis primarily contributed negative SHAP values, indicating that they tended to reduce the model&#8217;s output. This summary plot provided a comprehensive visualization of how each feature, and its value, contributed to the final prediction, offering valuable insights into the model&#8217;s decision-making process (see Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>).</p><p id="Par32">
<fig id="Fig3" position="float" orientation="portrait"><label>Fig. 3</label><caption><p>XAI: SHAP summary plot for SFS</p></caption><graphic id="d33e927" position="float" orientation="portrait" xlink:href="345_2025_5904_Fig3_HTML.jpg"/></fig>
</p></sec></sec><sec id="Sec58"><title>Haematuria limiting vision</title><sec id="Sec11"><title>ML training and testing results</title><p id="Par33">Top-performing models for haematuria prediction include XGBoost, Bagging Classifier, and CatBoost, with over 97% training accuracy and 93&#8211;94% validation accuracy. Decision Tree, Extra Trees, and Random Forest showed high accuracy but slight overfitting. Gradient Boosting and AdaBoost performed well with validation accuracy between 83 and 90%. SVM-Linear and Logistic Regression showed strong generalization with 76&#8211;78% validation accuracy. Overall, ensemble methods outperformed individual models, while linear models demonstrated solid generalization.</p></sec><sec id="Sec12"><title>Analysis of correlation and logistic regression</title><p id="Par34">The analysis of factors associated with haematuria after ureteroscopy in anomalous kidneys revealed several key correlations. Abandoned operations (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2353), reintervention (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2128), and on-table RF (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1718) were moderately linked to increased bleeding risk, highlighting the role of procedural complexity. Sepsis (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1211) also showed a mild positive correlation. Stone characteristics, including Hounsfield unit (HU) and diameter, had weak associations, while MK strongly reduced haematuria risk (<italic toggle="yes">r</italic>=-0.8352). Patient factors like age, sex, diabetes mellitus (DM), and operative time showed minimal impact. Overall, procedural complexity and anatomical features were more influential than patient characteristics in predicting haematuria.</p><p id="Par35">The logistic regression model for haematuria had a Log-Likelihood of -95.220 and a low Pseudo R-squared of 0.0612, indicating weak predictive power. The model&#8217;s overall significance was not supported by the LLR p-value of 0.2583. hypertension (HTN) (coef&#8201;=&#8201;0.9936, p&#8201;=&#8201;0.067) showed a potential positive correlation with haematuria, while DM (coef=-1.1036, p&#8201;=&#8201;0.171) suggested a negative association, though neither were statistically significant. &#8220;Sex&#8221; (coef=-0.5030, p&#8201;=&#8201;0.130) also lacked significance. Issues with multicollinearity or missing data led to &#8216;nan&#8217; values for some predictors. High standard errors further indicated instability in coefficient estimates.</p></sec></sec><sec id="Sec59"><title>Postoperative sepsis</title><sec id="Sec13"><title>ML training and testing results</title><p id="Par36">XGBoost led with 97.91% training accuracy, 93.86% validation accuracy, and a 71.44% F1-score. Gradient Boosting followed with 95.34% training and 92.10% validation accuracy, and a 67.88% F1-score, showing strong generalization. Decision Tree, Random Forest, and Extra Trees had high training accuracy (~&#8201;98.16%) and solid validation (87&#8211;90%), but showed overfitting. CatBoost performed well with 97.05% training accuracy and 89.47% validation accuracy. Bagging Classifier had decent performance (97.42% training, 87.71% validation) but a lower F1-score (52.94%). AdaBoost offered good balance with 86.15% training and 83.33% validation accuracy, and a 54.06% F1-score. SVM-Linear, Logistic Regression, and LDA showed moderate training accuracy (~&#8201;81&#8211;83%) but stable validation (~&#8201;75&#8211;82%) and F1-scores (52&#8211;56%). Ensemble models, especially XGBoost, Gradient Boosting, and Random Forest, outperformed individual models, while linear models showed solid generalization. Tree-based models overfitted, and SVM-RBF, SVM-Poly, and Na&#239;ve Bayes consistently underperformed.</p></sec><sec id="Sec14"><title>Analysis of correlation and logistic regression</title><p id="Par37">The analysis of sepsis risk factors identified several moderate to weak correlations. Reintervention (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1723), longer operative times (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1702), and comorbidities like HTN (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1628) and DM (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1570) were moderate contributors, emphasizing the role of surgical complexity and patient conditions. Positive correlations were also found with on-table RF (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1257) and haematuria (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1211), suggesting they may increase infection risk. Conversely, factors like MK (<italic toggle="yes">r</italic>=-0.0216), larger stone diameter (<italic toggle="yes">r</italic>=-0.0980), more stones (<italic toggle="yes">r</italic>=-0.0504), and achieving stone-free status (<italic toggle="yes">r</italic>=-0.0501) showed weak negative correlations, hinting at a minor protective effect. Overall, procedural complexity and comorbidities were more influential in predicting sepsis than anatomical factors or stone characteristics.</p><p id="Par38">The model performance metrics indicate a Log-Likelihood of -117.47, reflecting the model&#8217;s fit, with a higher (less negative) value being preferred. The Pseudo R-squared value of 0.1271 suggests weak predictive power, as it explains only a small portion of the variance in the data. However, the LLR p-value of 0.0001697 is highly significant, indicating that at least one predictor in the model is statistically significant.</p></sec></sec><sec id="Sec60"><title>Abandoned operation</title><sec id="Sec15"><title>ML training and testing results</title><p id="Par39">CatBoost was the top performer with 98.64% training and 98.25% validation accuracy, but its F1-score (49.56%) indicates class imbalance. XGBoost followed closely with similar accuracy (98.97% training, 97.36% validation) and an F1-score of 49.33%. Random Forest, Decision Tree, and Extra Trees had high accuracy (99.32% training, 97.36% validation) but showed signs of overfitting. Bagging Classifier performed well (98.75% training, 96.49% validation) with less overfitting. Gradient Boosting also performed solidly (97.85% training, 95.61% validation, 48.87% F1-score). Logistic Regression and LDA showed balanced performance with ~&#8201;84% training and 85% validation accuracy, and F1-scores around 46&#8211;47%. AdaBoost had good generalization (96.26% training, 95.61% validation, 48.88% F1-score). CatBoost and XGBoost achieved best results, with Gradient Boosting, Bagging, and AdaBoost also performing well. Logistic Regression and LDA offered good generalization, while SVM-RBF and Na&#239;ve Bayes underperformed.</p></sec><sec id="Sec16"><title>Analysis of correlation and logistic regression</title><p id="Par40">HTN emerged as the strongest predictor of an abandoned operation (<italic toggle="yes">r</italic>&#8201;=&#8201;0.6615), indicating a high risk in these patients. Other contributing factors included haematuria (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2353), on-table RF (<italic toggle="yes">r</italic>&#8201;=&#8201;0.2105), and reintervention (<italic toggle="yes">r</italic>&#8201;=&#8201;0.1898), reflecting the impact of procedural complexity. Operative time, DM, and sepsis showed weaker associations. In contrast, higher HU values, multiple stones, and achieving SFS were weakly protective. These results suggest that patient comorbidities and intraoperative challenges are key drivers of surgical abandonment.</p><p id="Par41">The model performance metrics show a Log-Likelihood of -42.737, reflecting the model&#8217;s fit, with a higher (less negative) value indicating a better fit. The Pseudo R-squared value of 0.1913 indicates moderate predictive power, explaining 19.13% of the variance. The LLR p-value of 0.02724 suggests that at least one predictor is statistically significant. However, the warning about exceeding the maximum number of iterations indicates potential issues such as multicollinearity, imbalanced data, large feature coefficients, or poor scaling of numerical variables.</p></sec></sec></sec><sec id="Sec17"><title>Discussion</title><p id="Par42">This is the first real-world evaluation of fURS outcomes in a cohort of patients affected by kidney anomalies, reporting findings of a ML predictive model. Our results offer valuable insights into the management of urolithiasis in patients with congenital renal anomalies using fURS. XAI tools, particularly decision trees and SHAP values, were instrumental in uncovering patterns that may otherwise be obscured by conventional statistical analysis.</p><p id="Par43">Among the key takeaways, on-table RF emerged as the most impactful variable influencing model predictions, reflecting the importance in predicting medium and long term SFS, a result in line with current literature [<xref ref-type="bibr" rid="CR6">6</xref>]. Operative time and patient&#8217;s age also showed strong contributions to the model&#8217;s output, with shorter operative durations and younger patients more frequently associated with anomalous kidneys, suggesting cautious procedural approaches or less complex stone burdens in those populations [<xref ref-type="bibr" rid="CR7">7</xref>]. Moreover, a significant correlation between risk of incomplete clearance and stone burden, in line with previous studies, was found [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Postoperative complications were also accurately predicted by our ML models. In particular, ML analysis achieved over 90% accuracy in predicting occurrence of sepsis, and a link was found with features such as operative time and concurrent comorbidities (HTN, DM).</p><p id="Par44">One of the most striking observations is the relative ease with which kidney malrotation were managed compared to other anomaly types. The decision tree analysis indicated that MK cases were consistently classified with fewer branching decisions and lower Gini impurity, suggesting more predictable surgical outcomes. This is supported by clinical experience, as malrotation may affect orientation but often does not compromise ureteral access as severely as pelvic ectopic or horseshoe kidneys. In contrast, ectopic kidneys posed greater variability in classification and were associated with higher procedural complexity and heterogeneity in feature influence [<xref ref-type="bibr" rid="CR10">10</xref>]. Horseshoe kidneys, while structurally distinct, exhibited moderate predictive clarity but still required nuanced consideration due to their variable vascular and ureteral anatomy [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. In this context, fURS has proven to be a safe and effective option to treat urolithiasis in MK, also when compared to PCNL [<xref ref-type="bibr" rid="CR13">13</xref>].</p><p id="Par45">The SHAP plots enriched this understanding by quantifying the individualized contribution of each feature to the model&#8217;s output. Features like the number of stones and the presence of an PEK demonstrated wide SHAP value distributions, indicating their context-specific impact on prediction. This reflects the real-world variability in anatomy and stone burden among patients with renal anomalies, emphasizing the need for personalized risk assessment.</p><sec id="Sec18"><title>Limitations of the study</title><p id="Par46">Despite these strengths, several limitations must be acknowledged. First, the retrospective design inherently limits causal inference and may be subject to selection and information bias. Second, the sample size, particularly for rare anomaly types like pelvic ectopic kidneys, may not be sufficient to generalize findings across broader populations. Nevertheless, being this the first report, and given the scarcity of literature evidence on the topic, we believe the sample to be considered adequate for the study. Third, the absence of standardized definitions for procedural success, complication grading, and anomaly classification across the literature hampers comparison and benchmarking. Additionally, while XAI improves transparency, it remains an evolving field, and interpretability does not replace the need for clinical validation. Future studies should also look at the cost and quality of life aspects of stone disease and AI integration into building predictive models.</p><p id="Par47">Overall, this study highlights the utility of ML and XAI in enhancing our understanding of complex surgical populations. The insights provided by XAI can support more informed clinical decisions, especially in the absence of robust guidelines for URS in anatomically variant kidneys. Further prospective, multicentric studies are warranted to validate these findings and to guide the development of standardized treatment protocols for this unique patient cohort.</p></sec><sec id="Sec19"><title>Key findings</title><p id="Par48">In this study, several key findings emerged regarding factors influencing SFS following fURS. Among anatomical variants, malrotated kidneys were associated with the most favourable outcomes, exhibiting more predictable and successful achievement of SFS compared to ectopic and horseshoe kidneys. The presence of RF at the end of surgery was identified as the strongest negative predictor of SFS, contributing approximately 30% to the model&#8217;s decision-making process and underscoring its clinical importance in evaluating procedural completeness. Higher SFS rates were also associated with shorter operative times and younger patient age, likely reflecting less complex stone burdens and reduced anatomical challenges. Conversely, ectopic and horseshoe kidneys were more frequently linked to lower SFS rates and increased uncertainty in predictions, highlighting the critical role of anatomical variation in procedural success. SHAP analysis revealed that specific features, such as the number of stones and type of anomaly, exerted patient-specific influences on outcomes, emphasizing the importance of individualized treatment planning. Furthermore, XAI methods enabled transparent and clinically interpretable predictions of SFS, providing an evidence-based framework to enhance preoperative risk stratification and guide patient counselling.</p></sec></sec><sec id="Sec20"><title>Conclusion</title><p id="Par49">This study used explainable AI to identify predictors SFS after fURS in patients with congenital renal anomalies. Malrotated kidneys had the highest SFS rates, suggesting they offer more favourable anatomy for stone clearance. In contrast, ectopic and horseshoe kidneys were linked to lower success and more residual fragments, the strongest negative predictor of SFS. Decision trees and SHAP plots provided transparent, clinically aligned insights into outcomes. These findings support the role of XAI in improving decision-making and highlight the need for prospective studies to standardize care in this complex population.</p></sec></body><back><fn-group><fn><p><bold>Publisher&#8217;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><notes notes-type="author-contribution"><title>Author contributions</title><p>CN: writing, data analysis, conceptualisationVG: database, conceptualisation, editing, revisionSA: data analysis, figuresNA: data analysis, figuresSG: data analysis, figuresHS: data analysis, figuresDC: conceptualisation, editing, revisionAG: conceptualisation, editing, revisionFP: conceptualisation, editing, revisionYT: editing, revisionAS: editing, revisionVS: editing, revisionAS: editing, revisionBS: editing, revisionMAL: editing, revisionSBH: editing, revisionBKS: database, conceptualisation, editing, revision, supervision.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>Open access funding provided by Universit&#224; Politecnica delle Marche within the CRUI-CARE Agreement. Human Ethics and Consent to Participate declarations: not applicable.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>No datasets were generated or analysed during the current study.</p></notes><notes><title>Declarations</title><notes id="FPar1" notes-type="COI-statement"><title>Conflict of interest</title><p id="Par50">The authors declare no competing interests.</p></notes><notes id="FPar2"><title>Ethical approval</title><p id="Par51">Ethical approval given the anonymous and retrospective nature of the study, no ethical approval was needed according to our Internal Review Board (IRB).</p></notes><notes id="FPar3"><title>Consent to participate</title><p id="Par52">Consent to participate all patients included in the study signed an informed consent for data collection and research analysis.</p></notes><notes id="FPar4"><title>Human ethics and consent to participate</title><p id="Par53">Not applicable.</p></notes></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><citation-alternatives><element-citation id="ec-CR1" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Garc&#237;a Rojo</surname><given-names>E</given-names></name><name name-style="western"><surname>Teoh</surname><given-names>JY-C</given-names></name><name name-style="western"><surname>Castellani</surname><given-names>D</given-names></name><etal/></person-group><article-title>Real-world global outcomes of retrograde intrarenal surgery in anomalous kidneys: A high volume international multicenter study</article-title><source>Urology</source><year>2022</year><volume>159</volume><fpage>41</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1016/j.urology.2021.10.003</pub-id><pub-id pub-id-type="pmid">34715241</pub-id></element-citation><mixed-citation id="mc-CR1" publication-type="journal">Garc&#237;a Rojo E, Teoh JY-C, Castellani D et al (2022) Real-world global outcomes of retrograde intrarenal surgery in anomalous kidneys: A high volume international multicenter study. Urology 159:41&#8211;47. 10.1016/j.urology.2021.10.003<pub-id pub-id-type="pmid">34715241</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.urology.2021.10.003</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR2"><label>2.</label><citation-alternatives><element-citation id="ec-CR2" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lavan</surname><given-names>L</given-names></name><name name-style="western"><surname>Herrmann</surname><given-names>T</given-names></name><name name-style="western"><surname>Netsch</surname><given-names>C</given-names></name><etal/></person-group><article-title>Outcomes of ureteroscopy for stone disease in anomalous kidneys: a systematic review</article-title><source>World J Urol</source><year>2020</year><volume>38</volume><fpage>1135</fpage><lpage>1146</lpage><pub-id pub-id-type="doi">10.1007/s00345-019-02810-x</pub-id><pub-id pub-id-type="pmid">31101967</pub-id><pub-id pub-id-type="pmcid">PMC7190593</pub-id></element-citation><mixed-citation id="mc-CR2" publication-type="journal">Lavan L, Herrmann T, Netsch C et al (2020) Outcomes of ureteroscopy for stone disease in anomalous kidneys: a systematic review. World J Urol 38:1135&#8211;1146. 10.1007/s00345-019-02810-x<pub-id pub-id-type="pmid">31101967</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s00345-019-02810-x</pub-id><pub-id pub-id-type="pmcid">PMC7190593</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR3"><label>3.</label><citation-alternatives><element-citation id="ec-CR3" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Spinos</surname><given-names>T</given-names></name><name name-style="western"><surname>Tatanis</surname><given-names>V</given-names></name><name name-style="western"><surname>Seitz</surname><given-names>C</given-names></name><etal/></person-group><article-title>Percutaneous nephrolithotomy (PCNL) versus other treatments for stone management in horseshoe kidneys: A systematic review</article-title><source>Arab J Urol</source><year>2024</year><volume>22</volume><fpage>243</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1080/20905998.2024.2312699</pub-id><pub-id pub-id-type="pmid">39355798</pub-id><pub-id pub-id-type="pmcid">PMC11441046</pub-id></element-citation><mixed-citation id="mc-CR3" publication-type="journal">Spinos T, Tatanis V, Seitz C et al (2024) Percutaneous nephrolithotomy (PCNL) versus other treatments for stone management in horseshoe kidneys: A systematic review. Arab J Urol 22:243&#8211;252. 10.1080/20905998.2024.2312699<pub-id pub-id-type="pmid">39355798</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1080/20905998.2024.2312699</pub-id><pub-id pub-id-type="pmcid">PMC11441046</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR4"><label>4.</label><mixed-citation publication-type="other">Skolarikos A, Jung H, Neisius A et al (2023) EAU Guidelines on Urolithiasis. In: Edn. presented at the EAU Annual Congress Milan 2023. <ext-link ext-link-type="uri" xlink:href="https://uroweb.org/guidelines/urolithiasis">https://uroweb.org/guidelines/urolithiasis</ext-link>. Accessed 11 Oct 2023</mixed-citation></ref><ref id="CR5"><label>5.</label><citation-alternatives><element-citation id="ec-CR5" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yi</surname><given-names>X</given-names></name><name name-style="western"><surname>Cao</surname><given-names>D</given-names></name><name name-style="western"><surname>You</surname><given-names>P</given-names></name><etal/></person-group><article-title>Comparison of the efficacy and safety of extracorporeal shock wave lithotripsy and flexible ureteroscopy for treatment of urolithiasis in horseshoe kidney patients: A systematic review and Meta-Analysis</article-title><source>Front Surg</source><year>2021</year><volume>8</volume><fpage>726233</fpage><pub-id pub-id-type="doi">10.3389/fsurg.2021.726233</pub-id><pub-id pub-id-type="pmid">34760915</pub-id><pub-id pub-id-type="pmcid">PMC8572974</pub-id></element-citation><mixed-citation id="mc-CR5" publication-type="journal">Yi X, Cao D, You P et al (2021) Comparison of the efficacy and safety of extracorporeal shock wave lithotripsy and flexible ureteroscopy for treatment of urolithiasis in horseshoe kidney patients: A systematic review and Meta-Analysis. Front Surg 8:726233. 10.3389/fsurg.2021.726233<pub-id pub-id-type="pmid">34760915</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3389/fsurg.2021.726233</pub-id><pub-id pub-id-type="pmcid">PMC8572974</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Cormio A, Mantovan M, Palantrani V et al (2025) A narrative review on extracorporeal shock wave lithotripsy, ureterolithotripsy, and percutaneous nephrolithotripsy in patients with anomalous kidneys. Minerva Urol Nephrol 77. 10.23736/S2724-6051.25.06001-X<pub-id pub-id-type="doi" assigning-authority="pmc">10.23736/S2724-6051.25.06001-X</pub-id><pub-id pub-id-type="pmid">40183182</pub-id></mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Wani M, Mohamed AHA, Brown G et al (2023) Challenges and options for management of stones in anomalous kidneys: a review of current literature. Ther Adv Urol 15. 10.1177/17562872231217797<pub-id pub-id-type="doi" assigning-authority="pmc">10.1177/17562872231217797</pub-id><pub-id pub-id-type="pmcid">PMC10749522</pub-id><pub-id pub-id-type="pmid">38146488</pub-id></mixed-citation></ref><ref id="CR8"><label>8.</label><citation-alternatives><element-citation id="ec-CR8" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>H</given-names></name><name name-style="western"><surname>Chen</surname><given-names>G</given-names></name><name name-style="western"><surname>Pan</surname><given-names>Y</given-names></name><etal/></person-group><article-title>No wound for stones&#8201;&lt;&#8201;2&#160;cm in horseshoe kidney: A systematic review of comparative studies</article-title><source>Urol Int</source><year>2019</year><volume>103</volume><fpage>249</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1159/000500328</pub-id><pub-id pub-id-type="pmid">31096234</pub-id></element-citation><mixed-citation id="mc-CR8" publication-type="journal">Chen H, Chen G, Pan Y et al (2019) No wound for stones&#8201;&lt;&#8201;2&#160;cm in horseshoe kidney: A systematic review of comparative studies. Urol Int 103:249&#8211;255. 10.1159/000500328<pub-id pub-id-type="pmid">31096234</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1159/000500328</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR9"><label>9.</label><citation-alternatives><element-citation id="ec-CR9" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ozmerdiven</surname><given-names>G</given-names></name><name name-style="western"><surname>G&#252;ler</surname><given-names>Y</given-names></name><name name-style="western"><surname>Cicek</surname><given-names>C</given-names></name><etal/></person-group><article-title>The role of retrograde intrarenal surgery in kidney stones of upper urinary system anomalies</article-title><source>Folia Med (Plovdiv)</source><year>2023</year><volume>65</volume><fpage>226</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.3897/folmed.65.e77728</pub-id><pub-id pub-id-type="pmid">37144307</pub-id></element-citation><mixed-citation id="mc-CR9" publication-type="journal">Ozmerdiven G, G&#252;ler Y, Cicek C et al (2023) The role of retrograde intrarenal surgery in kidney stones of upper urinary system anomalies. Folia Med (Plovdiv) 65:226&#8211;234. 10.3897/folmed.65.e77728<pub-id pub-id-type="pmid">37144307</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3897/folmed.65.e77728</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR10"><label>10.</label><citation-alternatives><element-citation id="ec-CR10" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Salvi</surname><given-names>M</given-names></name><name name-style="western"><surname>Muto</surname><given-names>G</given-names></name><name name-style="western"><surname>Tuccio</surname><given-names>A</given-names></name><etal/></person-group><article-title>Active treatment of renal stones in pelvic ectopic kidney: systematic review of literature</article-title><source>Minerva Urol Nefrol</source><year>2020</year><volume>72</volume><fpage>691</fpage><lpage>697</lpage><pub-id pub-id-type="doi">10.23736/S0393-2249.20.03792-3</pub-id><pub-id pub-id-type="pmid">32298068</pub-id></element-citation><mixed-citation id="mc-CR10" publication-type="journal">Salvi M, Muto G, Tuccio A et al (2020) Active treatment of renal stones in pelvic ectopic kidney: systematic review of literature. Minerva Urol Nefrol 72:691&#8211;697. 10.23736/S0393-2249.20.03792-3<pub-id pub-id-type="pmid">32298068</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.23736/S0393-2249.20.03792-3</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR11"><label>11.</label><citation-alternatives><element-citation id="ec-CR11" publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Qaoud</surname><given-names>Y</given-names></name><name name-style="western"><surname>Al Tali</surname><given-names>M</given-names></name><name name-style="western"><surname>Boland</surname><given-names>F</given-names></name><etal/></person-group><article-title>Comparative evaluation of urolithiasis management options in patients with horseshoe kidney: A systematic review and meta-analysis</article-title><source>Curr Urol</source><year>2023</year><volume>17</volume><fpage>193</fpage><lpage>205</lpage><pub-id pub-id-type="doi">10.1097/CU9.0000000000000199</pub-id><pub-id pub-id-type="pmid">37448612</pub-id><pub-id pub-id-type="pmcid">PMC10337821</pub-id></element-citation><mixed-citation id="mc-CR11" publication-type="journal">Qaoud Y, Al Tali M, Boland F et al (2023) Comparative evaluation of urolithiasis management options in patients with horseshoe kidney: A systematic review and meta-analysis. Curr Urol 17:193&#8211;205. 10.1097/CU9.0000000000000199<pub-id pub-id-type="pmid">37448612</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1097/CU9.0000000000000199</pub-id><pub-id pub-id-type="pmcid">PMC10337821</pub-id></mixed-citation></citation-alternatives></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Guliev BG, Komyakov BK, Agagyulov MU, Andriyanov AA (2024) Retrograde endoscopic treatment of stones in horseshoe kidney. Urologiia. (3):50&#8211;56. Russian. PMID: 39563563.<pub-id pub-id-type="pmid">39563563</pub-id></mixed-citation></ref><ref id="CR13"><label>13.</label><mixed-citation publication-type="other">Lim EJ, Teoh JY, Fong KY et al (2023) Propensity score-matched analysis comparing retrograde intrarenal surgery with percutaneous nephrolithotomy in anomalous kidneys. Minerva Urol Nephrol 74. 10.23736/S2724-6051.22.04664-X<pub-id pub-id-type="doi" assigning-authority="pmc">10.23736/S2724-6051.22.04664-X</pub-id><pub-id pub-id-type="pmid">35147385</pub-id></mixed-citation></ref></ref-list></back></article>
        
    </metadata>
</record>
    </GetRecord>

</OAI-PMH>